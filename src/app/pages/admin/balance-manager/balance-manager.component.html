<main id="main" class="main">
	<div class="pagetitle">
		<h1>All Transactions</h1>
		<nav>
			<ol class="breadcrumb">
				<li class="breadcrumb-item">
					<a routerLink="/admin/dashboard">Admin</a>
				</li>
				<li class="breadcrumb-item">Balance Manager</li>
			</ol>
		</nav>
	</div>
	<!-- End Page Title -->

	<section class="section">
		<div class="row">
			<div class="col-lg-12">
				<div class="card">
					<div class="card-body pt-1">
						<div
							class="spinner-border text-primary"
							role="status"
							*ngIf="isDisplayed"
						></div>
						<div class="row pb-4">
							<div class="col-md-12 py-4 text-start">
								<app-balance-manager-search
									[itemsPerPage]="itemsPerPage"
									[pageNumber]="pageNumber"
									[balance_manager_filter]="-1"
									[autoRefresh]="false"
									(balanceManager)="search($event)"
								></app-balance-manager-search>
							</div>
						</div>

						<!-- Table with stripped rows -->
						<table
							class="table table-striped table-bordered"
							id="dash-all-transactions"
						>
							<thead>
								<tr>
									<th>SL</th>
									<th>Sender</th>
									<th>A Account</th>
									<th>C Account</th>
									<th *ngIf="currentRole != 'Merchant'">
										Old Balance
									</th>
									<th>Amount</th>
									<th *ngIf="currentRole != 'Merchant'">
										Commission
									</th>
									<th *ngIf="currentRole != 'Merchant'">
										Last Balance
									</th>
									<th>Transaction ID</th>
									<th>Type</th>
									<th>Status</th>
									<th>Date</th>
									<th>Action</th>
								</tr>
							</thead>
							<tbody>
								<tr
									*ngFor="
										let item of displayedData
											| paginate
												: {
														itemsPerPage:
															itemsPerPage,
														currentPage: pageNumber,
														totalItems: totalRows
												  };
										let i = index
									"
								>
									<td>{{ i + 1 }}</td>
									<td>{{ item?.sender }}</td>
									<td>{{ item?.agent_account_no }}</td>
									<td>{{ item?.customer_account_no }}</td>
									<td *ngIf="currentRole != 'Merchant'">
										{{ item?.old_balance | number }}
									</td>
									<td>
										{{ item?.amount | number }}
									</td>

									<td *ngIf="currentRole != 'Merchant'">
										{{ item?.commision | number }}
									</td>
									<td *ngIf="currentRole != 'Merchant'">
										{{ item?.last_balance | number }}
									</td>

									<td>{{ item?.transaction_id }}</td>
									<td>{{ item?.b_type }}</td>
									<td>
										<span
											class="badge bg-primary"
											*ngIf="item?.status === 'success'"
											>Success</span
										>
										<span
											class="badge bg-warning text-dark"
											*ngIf="item?.status === 'pending'"
											>Pending</span
										>
										<span
											class="badge bg-warning text-dark"
											*ngIf="item?.status === 'fake'"
											>Fake</span
										>
										<span
											class="badge bg-warning text-dark"
											*ngIf="!item?.status"
											>Fake</span
										>
										<span
											class="badge bg-danger"
											*ngIf="item?.status === 'rejected'"
											>Rejected</span
										>
										<span
											class="badge bg-success"
											*ngIf="item?.status === 'approved'"
											>Approved</span
										>
										<span
											class="badge bg-danger"
											*ngIf="item?.status === 'danger'"
											>Danger</span
										>
									</td>
									<td>
										<span>{{
											item?.formated_created_at
										}}</span>
										<!-- <p style="color: green;margin-bottom: 0px;">{{item?.date_in_words}}</p> -->
									</td>

									<td [width]="150">
										<a
											class="custom-icons"
											*ngIf="
												item?.status === 'danger' ||
												item?.status === 'pending'
											"
										>
											<i
												class="fa fa-check me-2"
												aria-hidden="true"
												title="Approve"
												(click)="
													doAction(
														'approved',
														item?.id,
														'approved'
													)
												"
											></i>
										</a>
										<a
											class="custom-icons"
											*ngIf="
												item?.status === 'danger' ||
												item?.status === 'pending'
											"
										>
											<i
												class="fa fa-times-circle me-2"
												aria-hidden="true"
												title="Reject"
												(click)="
													doAction(
														'rejected',
														item?.id,
														'rejected'
													)
												"
											></i>
										</a>
										<a class="custom-icons">
											<i
												class="fa fa-eye"
												aria-hidden="true"
												(click)="
													showData(mymodal, item)
												"
											></i>
										</a>
									</td>
								</tr>
							</tbody>
						</table>
						<div
							class="text-center recordnotfound"
							*ngIf="!displayedData"
						>
							Record not found
						</div>
						<!-- <app-pagination
							[allPagesNumber]="allPages"
							(changePage)="onPageChange($event)"
							*ngIf="allPages"
						></app-pagination> -->
						<div class="text-end pt-4">
							<pagination-controls
								(pageChange)="onPageChange($event)"
							></pagination-controls>
						</div>
						<!-- End Table with stripped rows -->
					</div>
				</div>
			</div>
		</div>
	</section>
	<ng-template #mymodal let-modal>
		<div class="modal-header">
			<div
				class="close"
				aria-label="Close"
				(click)="modal.dismiss('Cross click')"
			>
				<span aria-hidden="true">Ã—</span>
			</div>
		</div>
		<div class="modal-body">
			<table
				class="table table-striped table-bordered"
				id="dash-all-transactions"
			>
				<tbody>
					<tr>
						<td>Sender</td>
						<td>{{ showingData?.sender }}</td>
					</tr>
					<tr>
						<td>A Account</td>
						<td>{{ showingData?.agent_account_no }}</td>
					</tr>
					<tr>
						<td>C Account</td>
						<td>{{ showingData?.customer_account_no }}</td>
					</tr>
					<tr *ngIf="currentRole != 'Merchant'">
						<td>Old Balance</td>
						<td>
							{{ showingData?.old_balance | number }}
						</td>
					</tr>
					<tr>
						<td>Amount</td>
						<td>
							{{ showingData?.amount | number }}
						</td>
					</tr>
					<tr *ngIf="currentRole != 'Merchant'">
						<td>Commission</td>
						<td>
							{{ showingData?.commision | number }}
						</td>
					</tr>
					<tr *ngIf="currentRole != 'Merchant'">
						<td>Last Balance</td>
						<td>
							{{ showingData?.last_balance | number }}
						</td>
					</tr>
					<tr>
						<td>Transaction ID</td>
						<td>{{ showingData?.transaction_id }}</td>
					</tr>
					<tr>
						<td>Type</td>
						<td>{{ showingData?.b_type }}</td>
					</tr>
					<tr>
						<td>Status</td>
						<td>
							<span
								class="badge bg-primary"
								*ngIf="showingData?.status === 'success'"
								>Success</span
							>
							<span
								class="badge bg-warning text-dark"
								*ngIf="showingData?.status === 'pending'"
								>Pending</span
							>
							<span
								class="badge bg-warning text-dark"
								*ngIf="showingData?.status === 'fake'"
								>Fake</span
							>
							<span
								class="badge bg-danger"
								*ngIf="showingData?.status === 'rejected'"
								>Rejected</span
							>
							<span
								class="badge bg-success"
								*ngIf="showingData?.status === 'approved'"
								>Approved</span
							>
							<span
								class="badge bg-danger"
								*ngIf="showingData?.status === 'danger'"
								>Danger</span
							>
						</td>
					</tr>
					<tr>
						<td>Date</td>
						<td>{{ showingData?.formated_date }}</td>
					</tr>
				</tbody>
			</table>
		</div>
		<!-- <div class="modal-footer">
		<button type="button" class="btn btn-outline-dark" (click)="modal.close('Save click')">Ok</button>
	  </div> -->
	</ng-template>
</main>
